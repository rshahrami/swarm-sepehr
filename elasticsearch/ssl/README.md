<div dir=”rtl”>

# مقدمه
  
برای فعال سازی ssl، مراحل زیر را ادامه می‌دهیم. .توجه داریم که در ابتدای کار باید تعداد نودهای مورد نیاز را تعیین کنیم. بعد از تعیین تعداد نودها و ایجاد ssl، اضافه کردن نود جدید به عنوان کلاستر، وجود ندارد. ( توجه کنیم که به صورت replication  این کار امکان پذیر است.)

--------------------------------------------------------
# فایل تنظیمات


## instances.yml  

در این فایل، ما تعداد نودها و تنظیمات مربوط به آن را انجام می‌دهیم. نام‌های قرار داده شده در این فایل، باید با نام‌های سرویس‌های ایجاد شده از طریف فایل coppose یکی باشد.

--------------------------------------------------------  
## create-certs.yml

با استفاده از یک volume، فایل instances.yml را به مسیر /usr/share/elasticsearch/config/certificates درون container، mount می‌کنیم. با استفاده از دستور زیر، container مورد نظر را اجرا می‌کنیم.

```docker
  
docker-compose -f create-certs.yml run --rm create_certs
  
```

با اجرا container، فایل های cert در مسیر /certs درون container ایجاد می‌شود. این فایل‌ها را با ایجاد یک volume مسیر مورد نظر ( در اینجا /cert می‌باشد)، به خارج container و درون ماشین مجازی خود، قرار می‌دهیم.

-------------------------------------------------------------------
# dockerfile

با استفاده از dockerfile تمامی محتویات درون فولدر /cert که در ماشین مجازی وجود دارد، به درون image و در مسیر /usr/share/elasticsearch/config/certificates/ قرار می‌دهیم. اکنون image جدید را ایجاد کرده که شامل ssl برای 3 عدد گره می‌باشد. توجه داریم که فایل cert را در این repository قرار نداده‌ایم.
  
---------------------------------------------------------------------  
# image file version:

- docker.elastic.co/elasticsearch/elasticsearch:7.13.0

</div>
