<div dir=”rtl”>

# مقدمه
  
این قسمت شامل تمامی تنظیمات مورد استفاده برای logstash در این پروژه می‌باشد.

-------------------------------------------------------- 
# pipelines

همه ی pipeline های که در پروژه استفاده شده است، در این فایل قرار دارد. برای هر pipeline که احتیاج هست، یکی از این تنظیمات رو استفاده می‌کنیم. 

--------------------------------------------------------  
# settings
این قسمت شامل دو بخش config  و plugin می‌باشد.
  
  ### config
این قسمت، تنظیمات اولیه مربوط به logstash می‌باشد. این تنظیمات از طریق Dockerfile در درون image مورد نظز قرار می‌گیرد.
  

  ### plugin
در این پروژه از plugin پایگاه داده cassandra برای ارتباط گیری، استفاده شده است. این plugin از طریق Dockerfile در درون image قرار میگیرد.
  
  ### pipeline
این بخش به صورت مستقیم در فایل تنظیمات وجود ندارد. در صورتی که بخواهیم یک pipeline خاصی را اجرا کنیم، می توانیم تنظیمات مربوط به آن را درون همین فولدر (این فولدر را باید ایجاد کنیم) قرار می‌دهیم و سپس با استفاده از Dockerfile، این تنظیمات را به image مورد نظر انتقال می‌دهیم.

 
-------------------------------------------------------------------
# Dockerfile
با استفاده از image base مروبط به logstash، تمامی تنظیمات دورن فایل settings را در یک image قرار می‌دهیم. توجه داریم که اگ پروژه مدنظر، نیازمند ارتباط گیری با cassandra نباشد، خط مربوط به نصب plugin را به صورت کامنت قرار می‌دهیم. 

-------------------------------------------------------------------
# docker run 

اگر بخواهیم مستقیم یک container ایجاد نماییم، می‌توانیم از دستور docker run استفاده کنیم. در این مورد، دو حالت برای اجرا وجود دارد. اگر pipeline مورد نظر از طریق Dockerfile به image انتقال داده شده باشد، از دستور زیر برای اجرای container استفاده می‌کنیم.
  
```docker
  
  docker run --rm -it -v logstash:v1
```
 که در آن، logstash:v1 نام image می‌باشد که با استفاده از Dockerfile ایجاد شده است. اگر pipeline مورد نظر در Dockerfile نباشد، می‌توانیم از دستور زیر برای اجرای container استفاده نماییم.
  
 ```docker
  
  docker run --rm -it -v /path/to/directory/pipeline/:/usr/share/logstash/pipeline/ logstash:v1

``` 
  توجه داریم که نام logstash:v1 مربوط به یک image جدید بودن داشتن pipeline می‌باشد. شما می‌توانید هر نام دلخواهی را انتخاب نمایید.

---------------------------------------------------------------------  
# compose file
  
برای اجرای container در محیط docker-compose و swarm از فایل  yml استفاده می‌کنیم. برا این منظور، می‌توانیم pipeline را در دورن image و یا خارج از آن قرار دهیم. در صورتی که pipeline در خارج image قرار داشته باشد، می توانیم با استفاده از volume، ان را به درون container انتقال دهیم.
بدلیل اینکه در تنظیمات از ویژگی persisted در logstash استفاده شده است، باید فایل داده را بر روی سرور خود، mount کنیم. برای این کار می‌توانیم با دستور زیر، مسیر برای pipeline و data ایجاد کنیم.

```bash 
  
  mkdir /volume/logstash/pipeline/
  
  mkdir /volume/logstash/data/

```
  
  # image base version:
  
  docker.elastic.co/logstash/logstash:7.13.0

</div>

